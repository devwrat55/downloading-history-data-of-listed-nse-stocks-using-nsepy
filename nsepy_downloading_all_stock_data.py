import os
import os.path
import concurrent.futures
diri=os.getcwd()
diri = diri.replace("\\", "/")      
names = ["20MICRONS", "21STCENMGM", "3IINFOTECH", "3MINDIA", "3PLAND", "5PAISA", "63MOONS", "A2ZINFRA", "AARTIDRUGS", "AARTIIND", "AARVEEDEN", "AAVAS", "ABAN", "ABB", "ABBOTINDIA", "ABCAPITAL", "ABFRL", "ABSLBANETF", "ABSLNN50ET", "ACC", "ACCELYA", "ACE", "ADANIENT", "ADANIGAS", "ADANIGREEN", "ADANIPORTS", "ADANIPOWER", "ADANITRANS", "ADFFOODS", "ADHUNIKIND", "ADLABS", "ADORWELD", "ADROITINFO", "ADSL", "ADVANIHOTR", "ADVENZYMES", "AEGISCHEM", "AGARIND", "AGRITECH", "AGROPHOS", "AHLEAST", "AHLUCONT", "AHLWEST", "AIAENG", "AIONJSW", "AIRAN", "AJANTPHARM", "AJMERA", "AKSHARCHEM", "AKSHOPTFBR", "AKZOINDIA", "ALANKIT", "ALBERTDAVD", "ALBK", "ALEMBICLTD", "ALICON", "ALKALI", "ALKEM", "ALKYLAMINE", "ALLCARGO", "ALLSEC", "ALMONDZ", "ALOKINDS", "ALPA", "ALPHAGEO", "ALPSINDUS", "AMARAJABAT", "AMBER", "AMBIKCO", "AMBUJACEM", "AMDIND", "AMJLAND", "AMRUTANJAN", "ANANTRAJ", "ANDHRABANK", "ANDHRACEMT", "ANDHRAPAP", "ANDHRSUGAR", "ANIKINDS", "ANKITMETAL", "ANSALAPI", "ANSALHSG", "ANUP", "APARINDS", "APCL", "APCOTEXIND", "APEX", "APLAPOLLO", "APLLTD", "APOLLO", "APOLLOHOSP", "APOLLOPIPE", "APOLLOTYRE", "APOLSINHOT", "APTECHT", "ARCHIDPLY", "ARCHIES", "ARCOTECH", "ARIES", "ARIHANT", "ARIHANTSUP", "ARMANFIN", "AROGRANITE", "ARSHIYA", "ARSSINFRA", "ARTEMISMED", "ARVIND", "ARVINDFASN", "ARVSMART", "ASAHIINDIA", "ASAHISONG", "ASAL", "ASALCBR", "ASHAPURMIN", "ASHIANA", "ASHIMASYN", "ASHOKA", "ASHOKLEY", "ASIANHOTNR", "ASIANPAINT", "ASIANTILES", "ASPINWALL", "ASTEC", "ASTERDM", "ASTRAL", "ASTRAMICRO", "ASTRAZEN", "ASTRON", "ATFL", "ATLANTA", "ATUL", "ATULAUTO", "AUBANK", "AURIONPRO", "AUROPHARMA", "AUSOMENT", "AUTOAXLES", "AUTOIND", "AUTOLITIND", "AVADHSUGAR", "AVANTIFEED", "AVTNPL", "AXISBANK", "AXISCADES", "AXISGOLD", "AXISNIFTY", "AYMSYNTEX", "BAFNAPH", "BAGFILMS", "BAJAJ-AUTO", "BAJAJCON", "BAJAJELEC", "BAJAJFINSV", "BAJAJHIND", "BAJAJHLDNG", "BAJFINANCE", "BALAJITELE", "BALAMINES", "BALKRISHNA", "BALKRISIND", "BALLARPUR", "BALMLAWRIE", "BALPHARMA", "BALRAMCHIN", "BANARBEADS", "BANARISUG", "BANCOINDIA", "BANDHANBNK", "BANG", "BANKBARODA", "BANKBEES", "BANKINDIA", "BANSWRAS", "BASF", "BASML", "BATAINDIA", "BAYERCROP", "BBL", "BBTC", "BCG", "BCP", "BDL", "BEARDSELL", "BEDMUTHA", "BEL", "BEML", "BEPL", "BERGEPAINT", "BFINVEST", "BFUTILITIE", "BGRENERGY", "BHAGERIA", "BHAGYANGR", "BHAGYAPROP", "BHANDARI", "BHARATFORG", "BHARATGEAR", "BHARATRAS", "BHARATWIRE", "BHARTIARTL", "BHEL", "BIGBLOC", "BIL", "BILENERGY", "BINDALAGRO", "BIOCON", "BIOFILCHEM", "BIRLACABLE", "BIRLACORPN", "BIRLAMONEY", "BIRLATYRE", "BLBLIMITED", "BLISSGVS", "BLKASHYAP", "BLS", "BLUEDART", "BLUESTARCO", "BODALCHEM", "BOMDYEING", "BOSCHLTD", "BPCL", "BPL", "BRFL", "BRIGADE", "BRITANNIA", "BRNL", "BROOKS", "BSE", "BSELINFRA", "BSL", "BSLGOLDETF", "BSLNIFTY", "BSOFT", "BURNPUR", "BUTTERFLY", "BYKE", "CADILAHC", "CALSOFT", "CAMLINFINE", "CANBK", "CANFINHOME", "CANTABIL", "CAPACITE", "CAPLIPOINT", "CAPTRUST", "CARBORUNIV", "CAREERP", "CARERATING", "CASTEXTECH", "CASTROLIND", "CCHHL", "CCL", "CDSL", "CEATLTD", "CEBBCO", "CELEBRITY", "CENTENKA", "CENTEXT", "CENTRALBK", "CENTRUM", "CENTUM", "CENTURYPLY", "CENTURYTEX", "CERA", "CESC", "CESCVENT", "CGCL", "CGPOWER", "CHALET", "CHAMBLFERT", "CHEMBOND", "CHEMFAB", "CHENNPETRO", "CHOLAFIN", "CHOLAHLDNG", "CHROMATIC", "CIGNITITEC", "CIMMCO", "CINELINE", "CINEVISTA", "CIPLA", "CLEDUCATE", "CLNINDIA", "CMICABLES", "COALINDIA", "COCHINSHIP", "COLPAL", "COMPINFO", "COMPUSOFT", "CONCOR", "CONFIPET", "CONSOFINVT", "CONTROLPR", "CORALFINAC", "CORDSCABLE", "COROMANDEL", "CORPBANK", "COSMOFILMS", "COUNCODOS", "CPSEETF", "CREATIVE", "CREATIVEYE", "CREDITACC", "CREST", "CRISIL", "CROMPTON", "CSBBANK", "CTE", "CUB", "CUMMINSIND", "CUPID", "CYBERTECH", "CYIENT", "DAAWAT", "DABUR", "DALBHARAT", "DALMIASUG", "DAMODARIND", "DATAMATICS", "DBCORP", "DBL", "DBREALTY", "DBSTOCKBRO", "DCAL", "DCBBANK", "DCM", "DCMFINSERV", "DCMNVL", "DCMSHRIRAM", "DCW", "DECCANCE", "DEEPAKFERT", "DEEPAKNTR", "DEEPIND", "DELTACORP", "DELTAMAGNT", "DEN", "DENORA", "DFMFOODS", "DGCONTENT", "DHAMPURSUG", "DHANBANK", "DHANUKA", "DHARSUGAR", "DHFL", "DHUNINV", "DIAMONDYD", "DICIND", "DIGISPICE", "DISHTV", "DIVISLAB", "DIXON", "DLF", "DLINKINDIA", "DNAMEDIA", "DOLAT", "DOLLAR", "DONEAR", "DPSCLTD", "DPWIRES", "DREDGECORP", "DRREDDY", "DSSL", "DTIL", "DVL", "DWARKESH", "DYNAMATECH", "DYNPRO", "EASTSILK", "EBBETF0423", "EBBETF0430", "ECLERX", "EDELWEISS", "EICHERMOT", "EIDPARRY", "EIHAHOTELS", "EIHOTEL", "EIMCOELECO", "EKC", "ELECON", "ELECTCAST", "ELECTHERM", "ELGIEQUIP", "ELGIRUBCO", "EMAMILTD", "EMAMIPAP", "EMAMIREAL", "EMKAY", "EMMBI", "ENDURANCE", "ENERGYDEV", "ENGINERSIN", "ENIL", "EQ30", "EQUITAS", "ERIS", "EROSMEDIA", "ESABINDIA", "ESCORTS", "ESSARSHPNG", "ESSELPACK", "ESTER", "EUROMULTI", "EUROTEXIND", "EVERESTIND", "EXCEL", "EXCELINDUS", "EXIDEIND", "EXPLEOSOL", "FACT", "FAIRCHEM", "FCL", "FCONSUMER", "FCSSOFT", "FDC", "FEDERALBNK", "FEL", "FELDVR", "FIEMIND", "FILATEX", "FINCABLES", "FINEORG", "FINPIPE", "FLEXITUFF", "FLFL", "FLUOROCHEM", "FMGOETZE", "FMNL", "FORCEMOT", "FORTIS", "FOSECOIND", "FRETAIL", "FSC", "FSL", "GABRIEL", "GAEL", "GAIL", "GAL", "GALAXYSURF", "GALLANTT", "GALLISPAT", "GAMMNINFRA", "GANDHITUBE", "GANECOS", "GANESHHOUC", "GANGESSECU", "GARFIBRES", "GATI", "GAYAHWS", "GAYAPROJ", "GBGLOBAL", "GDL", "GEECEE", "GEEKAYWIRE", "GENESYS", "GENUSPAPER", "GENUSPOWER", "GEOJITFSL", "GEPIL", "GESHIP", "GET&D", "GFLLIMITED", "GHCL", "GICHSGFIN", "GICRE", "GILLANDERS", "GILLETTE", "GINNIFILA", "GIPCL", "GKWLIMITED", "GLAXO", "GLENMARK", "GLOBALVECT", "GLOBOFFS", "GLOBUSSPR", "GMBREW", "GMDCLTD", "GMMPFAUDLR", "GMRINFRA", "GNA", "GNFC", "GOACARBON", "GOCLCORP", "GODFRYPHLP", "GODREJAGRO", "GODREJCP", "GODREJIND", "GODREJPROP", "GOKEX", "GOKUL", "GOKULAGRO", "GOLDBEES", "GOLDENTOBC", "GOLDIAM", "GOLDSHARE", "GOLDTECH", "GOODLUCK", "GPIL", "GPPL", "GPTINFRA", "GRANULES", "GRAPHITE", "GRASIM", "GRAVITA", "GREAVESCOT", "GREENLAM", "GREENPANEL", "GREENPLY", "GREENPOWER", "GRINDWELL", "GROBTEA", "GRPLTD", "GRSE", "GSCLCEMENT", "GSFC", "GSKCONS", "GSPL", "GSS", "GTL", "GTLINFRA", "GTNIND", "GTPL", "GUFICBIO", "GUJALKALI", "GUJAPOLLO", "GUJGASLTD", "GULFOILLUB", "GULFPETRO", "GULPOLY", "GVKPIL", "HAL", "HARITASEAT", "HARRMALAYA", "HATHWAY", "HATSUN", "HAVELLS", "HBLPOWER", "HCC", "HCG", "HCL-INSYS", "HCLTECH", "HDFC", "HDFCAMC", "HDFCBANK", "HDFCLIFE", "HDFCMFGETF", "HDFCNIFETF", "HDFCSENETF", "HEG", "HEIDELBERG", "HERCULES", "HERITGFOOD", "HEROMOTOCO", "HESTERBIO", "HEXAWARE", "HFCL", "HGINFRA", "HGS", "HIKAL", "HIL", "HILTON", "HIMATSEIDE", "HINDALCO", "HINDCOMPOS", "HINDCOPPER", "HINDMOTORS", "HINDNATGLS", "HINDOILEXP", "HINDPETRO", "HINDUNILVR", "HINDZINC", "HIRECT", "HISARMETAL", "HITECH", "HITECHCORP", "HITECHGEAR", "HLVLTD", "HMVL", "HNDFDS", "HNGSNGBEES", "HONAUT", "HONDAPOWER", "HOVS", "HPL", "HSCL", "HSIL", "HTMEDIA", "HUBTOWN", "HUDCO", "IBMFNIFTY", "IBREALEST", "IBULHSGFIN", "IBULISL", "IBVENTURES", "ICICI500", "ICICIB22", "ICICIBANK", "ICICIBANKN", "ICICIBANKP", "ICICIGI", "ICICIGOLD", "ICICILIQ", "ICICILOVOL", "ICICIM150", "ICICIMCAP", "ICICINF100", "ICICINIFTY", "ICICINV20", "ICICINXT50", "ICICIPRULI", "ICICISENSX", "ICIL", "ICRA", "IDBI", "IDBIGOLD", "IDEA", "IDFC", "IDFCFIRSTB", "IDFNIFTYET", "IEX", "IFBAGRO", "IFBIND", "IFCI", "IFGLEXPOR", "IGARASHI", "IGL", "IGPL", "IIFL", "IIFLSEC", "IIFLWAM", "IMFA", "IMPAL", "IMPEXFERRO", "INDBANK", "INDHOTEL", "INDIACEM", "INDIAGLYCO", "INDIAMART", "INDIANB", "INDIANCARD", "INDIANHUME", "INDIGO", "INDLMETER", "INDNIPPON", "INDOCO", "INDORAMA", "INDOSTAR", "INDOTECH", "INDOTHAI", "INDOWIND", "INDRAMEDCO", "INDSWFTLAB", "INDSWFTLTD", "INDTERRAIN", "INDUSINDBK", "INEOSSTYRO", "INFIBEAM", "INFOMEDIA", "INFRABEES", "INFRATEL", "INFY", "INGERRAND", "INOXLEISUR", "INOXWIND", "INSECTICID", "INSPIRISYS", "INTELLECT", "INTENTECH", "INVENTURE", "IOB", "IOC", "IOLCP", "IPCALAB", "IRB", "IRCON", "IRCTC", "ISEC", "ISFT", "ISMTLTD", "ITC", "ITDC", "ITDCEM", "ITI", "IVC", "IVP", "IVZINGOLD", "IVZINNIFTY", "IZMO", "J&KBANK", "JAGRAN", "JAGSNPHARM", "JAIBALAJI", "JAICORPLTD", "JAMNAAUTO", "JAYAGROGN", "JAYBARMARU", "JAYNECOIND", "JAYSREETEA", "JBCHEPHARM", "JBMA", "JCHAC", "JHS", "JINDALPHOT", "JINDALPOLY", "JINDALSAW", "JINDALSTEL", "JINDRILL", "JINDWORLD", "JISLDVREQS", "JISLJALEQS", "JIYAECO", "JKCEMENT", "JKIL", "JKLAKSHMI", "JKPAPER", "JKTYRE", "JMA", "JMCPROJECT", "JMFINANCIL", "JMTAUTOLTD", "JOCIL", "JPASSOCIAT", "JPINFRATEC", "JPOLYINVST", "JPPOWER", "JSL", "JSLHISAR", "JSWENERGY", "JSWHL", "JSWSTEEL", "JTEKTINDIA", "JUBILANT", "JUBLFOOD", "JUBLINDS", "JUMPNET", "JUNIORBEES", "JUSTDIAL", "JYOTHYLAB", "KABRAEXTRU", "KAJARIACER", "KAKATCEM", "KALPATPOWR", "KAMATHOTEL", "KAMDHENU", "KANANIIND", "KANORICHEM", "KANSAINER", "KARDA", "KARURVYSYA", "KAUSHALYA", "KAYA", "KCP", "KCPSUGIND", "KDDL", "KEC", "KECL", "KEI", "KELLTONTEC", "KENNAMET", "KESORAMIND", "KHADIM", "KICL", "KILITCH", "KINGFA", "KIOCL", "KIRIINDUS", "KIRLFER", "KIRLOSBROS", "KIRLOSENG", "KIRLOSIND", "KITEX", "KKCL", "KMSUGAR", "KNRCON", "KOKUYOCMLN", "KOLTEPATIL", "KOPRAN", "KOTAKBANK", "KOTAKBKETF", "KOTAKGOLD", "KOTAKNIFTY", "KOTAKNV20", "KOTAKPSUBK", "KOTARISUG", "KOTHARIPET", "KOTHARIPRO", "KPITTECH", "KPRMILL", "KRBL", "KREBSBIO", "KRIDHANINF", "KSB", "KSCL", "KSERASERA", "KSK", "KSL", "KTKBANK", "KUANTUM", "KWALITY", "L&TFH", "LAKSHVILAS", "LALPATHLAB", "LAMBODHARA", "LAOPALA", "LAURUSLABS", "LAXMIMACH", "LEMONTREE", "LFIC", "LGBBROSLTD", "LGBFORGE", "LIBERTSHOE", "LICHSGFIN", "LICNETFGSC", "LICNETFN50", "LICNETFSEN", "LICNFNHGP", "LINCOLN", "LINCPEN", "LINDEINDIA", "LIQUIDBEES", "LIQUIDETF", "LOKESHMACH", "LOTUSEYE", "LOVABLE", "LPDC", "LSIL", "LT", "LTI", "LTTS", "LUMAXIND", "LUMAXTECH", "LUPIN", "LUXIND", "LYKALABS", "LYPSAGEMS", "M&M", "M&MFIN", "M100", "M50", "MAANALU", "MADHAV", "MADHUCON", "MADRASFERT", "MAGADSUGAR", "MAGMA", "MAGNUM", "MAHABANK", "MAHEPC", "MAHESHWARI", "MAHINDCIE", "MAHLIFE", "MAHLOG", "MAHSCOOTER", "MAHSEAMLES", "MAITHANALL", "MAJESCO", "MALUPAPER", "MAN50ETF", "MANAKALUCO", "MANAKCOAT", "MANAKSTEEL", "MANALIPETC", "MANAPPURAM", "MANGALAM", "MANGCHEFER", "MANGLMCEM", "MANINDS", "MANINFRA", "MANUGRAPH", "MANXT50", "MARALOVER", "MARATHON", "MARICO", "MARKSANS", "MARUTI", "MASFIN", "MASTEK", "MATRIMONY", "MAWANASUG", "MAXINDIA", "MAXVIL", "MAYURUNIQ", "MAZDA", "MBLINFRA", "MCDHOLDING", "MCDOWELL-N", "MCLEODRUSS", "MCX", "MEGASOFT", "MEGH", "MENONBE", "MEP", "MERCATOR", "METALFORGE", "METROPOLIS", "MFSL", "MGL", "MHRIL", "MIC", "MIDHANI", "MINDACORP", "MINDAIND", "MINDTECK", "MINDTREE", "MIRCELECTR", "MIRZAINT", "MMFL", "MMP", "MMTC", "MOHOTAIND", "MOIL", "MOLDTECH", "MOLDTKPAC", "MONTECARLO", "MORARJEE", "MOREPENLAB", "MOTHERSUMI", "MOTILALOFS", "MOTOGENFIN", "MPHASIS", "MPSLTD", "MRF", "MRPL", "MSPL", "MSTCLTD", "MTEDUCARE", "MTNL", "MUKANDENGG", "MUKANDLTD", "MUKTAARTS", "MUNJALAU", "MUNJALSHOW", "MURUDCERA", "MUTHOOTCAP", "MUTHOOTFIN", "N100", "NACLIND", "NAGAFERT", "NAGREEKCAP", "NAGREEKEXP", "NAHARCAP", "NAHARINDUS", "NAHARPOLY", "NAHARSPING", "NAM-INDIA", "NATCOPHARM", "NATHBIOGEN", "NATIONALUM", "NATNLSTEEL", "NAUKRI", "NAVINFLUOR", "NAVKARCORP", "NAVNETEDUL", "NBCC", "NBIFIN", "NBVENTURES", "NCC", "NCLIND", "NDGL", "NDL", "NDTV", "NECCLTD", "NECLIFE", "NELCAST", "NELCO", "NESCO", "NESTLEIND", "NETF", "NETFCONSUM", "NETFDIVOPP", "NETFLTGILT", "NETFMID150", "NETFNIF100", "NETFNV20", "NETWORK18", "NEULANDLAB", "NEWGEN", "NEXTMEDIA", "NFL", "NH", "NHPC", "NIACL", "NIFTYBEES", "NIITLTD", "NIITTECH", "NILAINFRA", "NILASPACES", "NILKAMAL", "NIPPOBATRY", "NITCO", "NITINSPIN", "NLCINDIA", "NMDC", "NOCIL", "NOIDATOLL", "NPBET", "NRAIL", "NRBBEARING", "NSIL", "NTL", "NTPC", "NUCLEUS", "NXTDIGITAL", "OAL", "OBEROIRLTY", "OCCL", "OFSS", "OIL", "OILCOUNTUB", "OISL", "OLECTRA", "OMAXAUTO", "OMAXE", "OMKARCHEM", "OMMETALS", "ONELIFECAP", "ONEPOINT", "ONGC", "ONMOBILE", "ONWARDTEC", "OPTIEMUS", "OPTOCIRCUI", "ORBTEXP", "ORICONENT", "ORIENTABRA", "ORIENTALTL", "ORIENTBANK", "ORIENTBELL", "ORIENTCEM", "ORIENTELEC", "ORIENTHOT", "ORIENTLTD", "ORIENTPPR", "ORIENTREF", "ORISSAMINE", "ORTINLABSS", "OSWALAGRO", "PAEL", "PAGEIND", "PAISALO", "PALASHSECU", "PALREDTEC", "PANACEABIO", "PANACHE", "PANAMAPET", "PAPERPROD", "PARACABLES", "PARAGMILK", "PARSVNATH", "PATELENG", "PATINTLOG", "PATSPINLTD", "PCJEWELLER", "PDMJEPAPER", "PDSMFL", "PEARLPOLY", "PEL", "PENIND", "PENINLAND", "PERSISTENT", "PETRONET", "PFC", "PFIZER", "PFOCUS", "PFS", "PGEL", "PGHH", "PGHL", "PGIL", "PHILIPCARB", "PHOENIXLTD", "PIDILITIND", "PIIND", "PILANIINVS", "PILITA", "PIONEEREMB", "PITTIENG", "PLASTIBLEN", "PNB", "PNBGILTS", "PNBHOUSING", "PNC", "PNCINFRA", "PODDARHOUS", "PODDARMENT", "POKARNA", "POLYCAB", "POLYMED", "POLYPLEX", "PONNIERODE", "POWERGRID", "POWERMECH", "PPAP", "PPL", "PRABHAT", "PRADIP", "PRAENG", "PRAJIND", "PRAKASH", "PRECAM", "PRECOT", "PRECWIRE", "PREMEXPLN", "PREMIER", "PREMIERPOL", "PRESSMN", "PRESTIGE", "PRICOLLTD", "PRIMESECU", "PRINCEPIPE", "PROSEED", "PROZONINTU", "PRSMJOHNSN", "PSB", "PSPPROJECT", "PSUBNKBEES", "PTC", "PTL", "PUNJABCHEM", "PURVA", "PVR", "QGOLDHALF", "QNIFTY", "QUESS", "QUICKHEAL", "RADICO", "RADIOCITY", "RAIN", "RAJESHEXPO", "RAJSREESUG", "RAJTV", "RALLIS", "RAMANEWS", "RAMASTEEL", "RAMCOCEM", "RAMCOIND", "RAMCOSYS", "RAMKY", "RANASUG", "RANEENGINE", "RANEHOLDIN", "RATNAMANI", "RAYMOND", "RBL", "RBLBANK", "RCF", "RCOM", "RECLTD", "REDINGTON", "REFEX", "RELAXO", "RELCAPITAL", "RELIANCE", "RELIGARE", "RELINFRA", "REMSONSIND", "RENUKA", "REPCOHOME", "REPRO", "RESPONIND", "REVATHI", "RGL", "RICOAUTO", "RIIL", "RITES", "RKDL", "RKFORGE", "RML", "RNAVAL", "ROHITFERRO", "ROHLTD", "ROLLT", "ROLTA", "ROSSELLIND", "RPGLIFE", "RPOWER", "RPPINFRA", "RSSOFTWARE", "RSWM", "RSYSTEMS", "RTNPOWER", "RUBYMILLS", "RUCHIRA", "RUPA", "RUSHIL", "RVNL", "SABTN", "SADBHAV", "SADBHIN", "SAFARI", "SAGCEM", "SAIL", "SAKAR", "SAKHTISUG", "SAKSOFT", "SAKUMA", "SALASAR", "SALONA", "SALSTEEL", "SALZERELEC", "SAMBHAAV", "SANCO", "SANDESH", "SANDHAR", "SANGAMIND", "SANGHIIND", "SANGHVIFOR", "SANGHVIMOV", "SANGINITA", "SANOFI", "SANWARIA", "SARDAEN", "SAREGAMA", "SARLAPOLY", "SASKEN", "SASTASUNDR", "SATHAISPAT", "SATIA", "SATIN", "SBICARD", "SBIETFQLTY", "SBILIFE", "SBIN", "SCAPDVR", "SCHAEFFLER", "SCHAND", "SCHNEIDER", "SCI", "SEAMECLTD", "SELAN", "SELMCL", "SEPOWER", "SEQUENT", "SESHAPAPER", "SETCO", "SETF10GILT", "SETFGOLD", "SETFNIF50", "SETFNIFBK", "SETFNN50", "SETUINFRA", "SEYAIND", "SFL", "SGL", "SHAKTIPUMP", "SHALBY", "SHALPAINTS", "SHANKARA", "SHANTIGEAR", "SHARDACROP", "SHARDAMOTR", "SHARIABEES", "SHEMAROO", "SHIL", "SHILPAMED", "SHIRPUR-G", "SHIVAMAUTO", "SHIVAMILLS", "SHIVATEX", "SHK", "SHOPERSTOP", "SHREDIGCEM", "SHREECEM", "SHREEPUSHK", "SHREERAMA", "SHRENIK", "SHREYANIND", "SHREYAS", "SHRIRAMCIT", "SHRIRAMEPC", "SHYAMCENT", "SICAGEN", "SICAL", "SIEMENS", "SIGIND", "SILINV", "SIMBHALS", "SIMPLEXINF", "SINTEX", "SIRCA", "SIS", "SITINET", "SIYSIL", "SJVN", "SKFINDIA", "SKIL", "SKIPPER", "SKMEGGPROD", "SMARTLINK", "SMLISUZU", "SMSLIFE", "SMSPHARMA", "SNOWMAN", "SOBHA", "SOLARA", "SOLARINDS", "SOMANYCERA", "SOMATEX", "SOMICONVEY", "SONATSOFTW", "SORILINFRA", "SOTL", "SOUTHBANK", "SOUTHWEST", "SPAL", "SPANDANA", "SPARC", "SPCENET", "SPECIALITY", "SPENCERS", "SPIC", "SPICEJET", "SPLIL", "SPMLINFRA", "SPTL", "SREEL", "SREINFRA", "SRF", "SRHHYPOLTD", "SRIPIPES", "SRTRANSFIN", "SSWL", "STAMPEDE", "STAR", "STARCEMENT", "STARPAPER", "STCINDIA", "STEELCITY", "STEELXIND", "STEL", "STERTOOLS", "STRTECH", "SUBEX", "SUBROS", "SUDARSCHEM", "SUMEETINDS", "SUMICHEM", "SUMMITSEC", "SUNCLAYLTD", "SUNDARAM", "SUNDARMFIN", "SUNDARMHLD", "SUNDRMBRAK", "SUNDRMFAST", "SUNFLAG", "SUNPHARMA", "SUNTECK", "SUNTV", "SUPERHOUSE", "SUPERSPIN", "SUPPETRO", "SUPRAJIT", "SUPREMEIND", "SUPREMEINF", "SURANASOL", "SURANAT&P", "SURYALAXMI", "SURYAROSNI", "SUTLEJTEX", "SUVEN", "SUZLON", "SWANENERGY", "SWARAJENG", "SWELECTES", "SWSOLAR", "SYMPHONY", "SYNCOM", "SYNDIBANK", "SYNGENE", "TAINWALCHM", "TAJGVK", "TAKE", "TALBROAUTO", "TANLA", "TARMAT", "TASTYBITE", "TATACHEM", "TATACOFFEE", "TATACOMM", "TATACONSUM", "TATAELXSI", "TATAINVEST", "TATAMETALI", "TATAMOTORS", "TATAMTRDVR", "TATAPOWER", "TATASTEEL", "TATASTLBSL", "TATASTLLP", "TBZ", "TCI", "TCIDEVELOP", "TCIEXP", "TCIFINANCE", "TCNSBRANDS", "TCPLPACK", "TCS", "TDPOWERSYS", "TEAMLEASE", "TECHM", "TECHNOE", "TECHNOFAB", "TEJASNET", "TERASOFT", "TEXINFRA", "TEXMOPIPES", "TEXRAIL", "TFCILTD", "TFL", "TGBHOTELS", "THANGAMAYL", "THEINVEST", "THEMISMED", "THERMAX", "THOMASCOOK", "THYROCARE", "TI", "TIDEWATER", "TIIL", "TIINDIA", "TIJARIA", "TIL", "TIMESGTY", "TIMETECHNO", "TIMKEN", "TINPLATE", "TIPSINDLTD", "TIRUMALCHM", "TITAN", "TMRVL", "TNPETRO", "TNPL", "TOKYOPLAST", "TORNTPHARM", "TORNTPOWER", "TOUCHWOOD", "TPLPLASTEH", "TREEHOUSE", "TREJHARA", "TRENT", "TRF", "TRIDENT", "TRIGYN", "TRIL", "TRITURBINE", "TRIVENI", "TTKHLTCARE", "TTKPRESTIG", "TTL", "TV18BRDCST", "TVSELECT", "TVSMOTOR", "TVSSRICHAK", "TVTODAY", "TWL", "UBL", "UCALFUEL", "UCOBANK", "UFLEX", "UFO", "UGARSUGAR", "UJAAS", "UJJIVAN", "UJJIVANSFB", "ULTRACEMCO", "UMANGDAIRY", "UMESLTD", "UNICHEMLAB", "UNIENTER", "UNIONBANK", "UNIPLY", "UNITEDBNK", "UNITEDTEA", "UNIVCABLES", "UNIVPHOTO", "UPL", "URJA", "USHAMART", "UTINEXT50", "UTINIFTETF", "UTISENSETF", "UTISXN50", "UTTAMSTL", "UTTAMSUGAR", "V2RETAIL", "VADILALIND", "VAIBHAVGBL", "VAISHALI", "VAKRANGEE", "VARDHACRLC", "VARDMNPOLY", "VARROC", "VASCONEQ", "VASWANI", "VBL", "VEDL", "VENKEYS", "VENUSREM", "VESUVIUS", "VETO", "VGUARD", "VHL", "VIDHIING", "VIJIFIN", "VIKASECO", "VIKASMCORP", "VIKASPROP", "VIKASWSP", "VIMTALABS", "VINATIORGA", "VINDHYATEL", "VINYLINDIA", "VIPCLOTHNG", "VIPIND", "VIPULLTD", "VISAKAIND", "VISASTEEL", "VISHNU", "VISHWARAJ", "VIVIDHA", "VIVIMEDLAB", "VLSFINANCE", "VMART", "VOLTAMP", "VOLTAS", "VRLLOG", "VSSL", "VSTIND", "VSTTILLERS", "VTL", "WABAG", "WABCOINDIA", "WALCHANNAG", "WATERBASE", "WEBELSOLAR", "WEIZMANIND", "WELCORP", "WELENT", "WELINV", "WELSPUNIND", "WENDT", "WESTLIFE", "WHEELS", "WHIRLPOOL", "WILLAMAGOR", "WINDMACHIN", "WIPRO", "WOCKPHARMA", "WONDERLA", "WSTCSTPAPR", "XCHANGING", "XELPMOC", "XPROINDIA", "YESBANK", "ZEEL", "ZEELEARN", "ZEEMEDIA", "ZENITHBIR", "ZENITHEXPO", "ZENSARTECH", "ZENTEC", "ZICOM", "ZODIACLOTH", "ZODJRDMKJ", "ZOTA", "ZUARI", "ZUARIGLOB", "ZYDUSWELL"]
import datetime
from datetime import timedelta
from nsepy import get_history
curr_date = datetime.datetime.now().date()
historyhundreddate = curr_date - timedelta(60) #downloading past2 month  data
def download_data(fpar):
    import datetime
    try:
        stock_hist_data =  get_history(symbol=fpar,
                   start=datetime.datetime(historyhundreddate.year, historyhundreddate.month, historyhundreddate.day), 
                   end = datetime.datetime(curr_date.year, curr_date.month, curr_date.day))
        aa=fpar[:]
        aa=aa.lower()
        location_name = diri+'/aa_nsepy_'+aa+'_data.csv'
        try:
            os.remove(location_name)
        except:
            pass
        stock_hist_data.to_csv(location_name)
    except:
        pass
    
#multi threading
with concurrent.futures.ThreadPoolExecutor() as executor:
   executor.map(download_data, names)  
       